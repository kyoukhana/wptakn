(function(e){e.fn.jegcontact=function(t){var n={location:new Array};if(t){var t=e.extend(n,t)}else{var t=e.extend(n)}var r=e(this);var i=false;if(navigator.userAgent.match(/iPhone/i)||navigator.userAgent.match(/iPod/i)||navigator.userAgent.match(/iPad/i)){i=true}if(!i){e(".contact_location .locdetail").jtooltip({})}var s=function(){e("#jeg-loader").stop().hide()};var o=function(){e("#jeg-loader").stop().show()};s();if(t.usemap==1){var u=function(n){var r=new Array;var i=new Array;var s,o;if(google==undefined||google.maps.MapTypeId==undefined){return null}var u={mapTypeId:google.maps.MapTypeId.ROADMAP,disableDefaultUI:true,scrollwheel:false,navigationControl:true,mapTypeControl:false,scaleControl:false,draggable:true,panControl:false,zoomControl:true,zoomControlOptions:{style:google.maps.ZoomControlStyle.SMALL,position:google.maps.ControlPosition.RIGHT_BOTTOM}};var a=new google.maps.Map(document.getElementById(n),u);var f=new google.maps.LatLngBounds;var l=function(e){var t="";var n="";if(e.address){t='<li><i class="icon-map-marker"></i><div class="loc-content">';for(var r=0;r<e.address.length;r++){t+="<div>"+e.address[r]+"<div>"}t+="</div></li>"}if(e.phone){if(e.phone[0]!=""){n='<li><i class="phone-icon"></i><div class="loc-content">';for(var r=0;r<e.phone.length;r++){n+="<div>"+e.phone[r]+"<div>"}n+="</div></li>"}}var i='<div class="infowindow">'+'<div class="infowindow-wrapper">'+"<h2>"+e.title+"</h2>"+"<ul>"+t+n+"</ul>"+"</div>"+'<div alt="Close" class="closeme" style="display: block;">'+'<div class="icon-remove icon-white"></div>'+"</div>"+"</div>";return i};var c=function(e,t,n){return new google.maps.Marker({position:e,map:t,zIndex:10})};var h=function(t,n,r){var s=new InfoBubble({map:a,content:l(t),position:r,shadowStyle:0,padding:0,backgroundColor:"rgba(125, 125, 125, 0.1)",borderRadius:5,arrowSize:10,borderWidth:.5,borderColor:"#fff",disableAutoPan:true,hideCloseButton:true,arrowPosition:40,backgroundClassName:"infowindowbg",arrowStyle:2});google.maps.event.addListener(i[n],"click",function(){p();s.open(a,i[n]);s.panToView();google.maps.event.addListenerOnce(s,"domready",function(){e("#contact_canvas .closeme").click(function(){p()})})});return s};var p=function(){for(var e=0;e<r.length;e++){r[e].close()}};var d=function(e){for(var t=0;t<e.length;t++){var n=new google.maps.LatLng(e[t].x,e[t].y);i[t]=c(n,a,10);r[t]=h(e[t],t,n);f.extend(n)}};var v=function(){a.setZoom(o);a.panTo(s)};d(t.location);if(t.location.length>1){a.fitBounds(f);s=f.getCenter();var m=true;google.maps.event.addListener(a,"bounds_changed",function(){o=m?a.getZoom():o;m=false})}else{a.setCenter(f.getCenter());a.setZoom(t.zoomfactor);s=f.getCenter()}return{map:a,infoBubble:r,marker:i,closeBubble:p,centerMap:v}};var a=u("contact_canvas");if(a!==null){var f=new google.maps.DirectionsRenderer;var l=new google.maps.DirectionsService;var c=null;f.setMap(a.map)}else{notifbox("Google map cannot loaded, if you use addon plus, please turn it off")}var h=function(){if(a!==null){if(c!==null){a.map.setCenter(c)}c=a.map.getCenter()}};e(window).resize(function(){if(!scw(mediaquerywidth)){v();e(".contactflag").hide();e(".contact_form").attr("style","")}h()});var p=function(){e(".locationflag").hide();e(".contact_location").animate({"margin-left":"-10"},"slow")};var d=function(){p();e(".contact_form").animate({left:"100%","margin-left":"0"},"slow",function(){e(".contactflag").show()})};var v=function(){e(".contact_location").animate({"margin-left":"-276"},"slow",function(){e(".locationflag").show()})};var m=function(){v();var t="-"+e(".contact_form").width()/2;e(".contactflag").hide();e(".contact_form").animate({left:"50%","margin-left":t},"slow",function(){})};var g=function(t){var n=e(t).attr("data-x");var r=e(t).attr("data-y");var i=e(t).attr("data-index");var s=new google.maps.LatLng(n,r);a.map.panTo(s);a.closeBubble();a.infoBubble[i].open(a.map,a.marker[i]);google.maps.event.addListenerOnce(a.infoBubble[i],"domready",function(){e("#contact_canvas .closeme").click(function(){a.closeBubble()})})};var y=function(e,n,r,i){var o={origin:new google.maps.LatLng(e,n),destination:new google.maps.LatLng(r,i),travelMode:google.maps.DirectionsTravelMode.DRIVING};l.route(o,function(e,n){if(n==google.maps.DirectionsStatus.OK){v();f.setDirections(e)}else{notifbox(t.cantgetdirection,5e3)}s()})};if(Modernizr.geolocation){e(".contact_location .locdetail").bind("click",function(){if(a===null)return;var n;var r;var i=e(this).attr("data-x");var s=e(this).attr("data-y");o();if(navigator.geolocation){navigator.geolocation.getCurrentPosition(function(e){n=e.coords.latitude;r=e.coords.longitude;y(n,r,i,s)},function(){notifbox(t.cantgetdirection,5e3)},{timeout:1e4})}})}else{notifbox(t.geonotsupport,5e3)}var b=function(){e("html, body").animate({scrollTop:0})};var w=function(){e("html, body").animate({scrollTop:e(".contact_form").offset().top})};var E=function(){a.centerMap()};e(".hideform, .locationflag, .view-map").bind("click",function(){d()});e(".contactflag").bind("click",function(){m()});e(".hidelocation").bind("click",function(){v()});e(".contact_location .locdetail").bind("mouseenter",function(){if(a===null){return}g(this)});e(".contactotop").bind("click",function(){b();return false});e(".contacttobottom").bind("click",function(){w();return false});e(".cntactocenter").bind("click",function(){E();return false});var S=e(".locationlist").jScrollPane().data().jsp;if(scw(iphonewidth)){e(".contact_form").touchwipe({wipeRight:function(){d();return false},min_move_x:20,min_move_y:20,preventDefaultEvents:true})}e(".contact_location").touchwipe({wipeLeft:function(){m();return false},min_move_x:20,min_move_y:20,preventDefaultEvents:true});if(t.showmapfirst==1){setTimeout(function(){d()},1500)}}e("#contactform").validate({errorElement:"span",errorPlacement:function(t,n){var r=e(n).parent().find(".contact_error");r.html(t)},rules:{contact_name:{required:true,minlength:2},contact_email:{required:true,email:true},contact_message:{required:true,minlength:10}},messages:{contact_name:{required:t.entername,minlength:jQuery.format(t.nameminlength)},contact_email:{required:t.enteremail,email:t.validemail},contact_message:{required:t.entermessage,minlength:jQuery.format(t.messageminlength)}},submitHandler:function(n){var r={name:e("#contact_name").val(),email:e("#contact_email").val(),message:e("#contact_message").val(),action:"contact"};var i=function(){e("input:text, input:password, input:file, select, textarea, input:radio, input:checkbox",n).attr("disabled","disabled")};var s=function(){e("input:text, input:password, input:file, select, textarea, input:radio, input:checkbox",n).removeAttr("disabled")};var o=function(){e(n)[0].reset()};var u=function(){e("button",n).hide();e(".contact_loader",n).show()};var a=function(){e("button",n).show();e(".contact_loader",n).hide()};notifbox(t.sendmessage,0);i();u();e.ajax({url:admin_url,type:"post",dataType:"json",data:r,success:function(e){if(e.status==1){notifbox(t.messagesent,5e3);o()}else{notifbox(t.failsentmessage,5e3)}s();a();return false},timeout:function(){notifbox(t.failsentmessage,5e3);s();a();return false},error:function(){notifbox(t.failsentmessage,5e3);s();a();return false}});return false}})}})(jQuery)